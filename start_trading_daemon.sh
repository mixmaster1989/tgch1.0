#!/bin/bash
"""
ะกะบัะธะฟั ะทะฐะฟััะบะฐ ัะพัะณะพะฒะพะณะพ ะฑะพัะฐ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต
ะะพั ะฑัะดะตั ัะฐะฑะพัะฐัั ะดะฐะถะต ะฟะพัะปะต ะทะฐะบัััะธั SSH ัะตััะธะธ
"""

# ะะฐัััะพะนะบะธ
BOT_NAME="mexca_trading_bot"
LOG_FILE="trading_bot.log"
PID_FILE="trading_bot.pid"
PYTHON_SCRIPT="run_auto_trader.py"

echo "๐ ะะะะฃะกะ ะขะะะะะะะะ ะะะขะ ะ ะคะะะะะะ ะะะะะะ"
echo "=========================================="

# ะัะพะฒะตััะตะผ, ะฝะต ะทะฐะฟััะตะฝ ะปะธ ัะถะต ะฑะพั
if [ -f "$PID_FILE" ]; then
    PID=$(cat "$PID_FILE")
    if ps -p $PID > /dev/null 2>&1; then
        echo "โ ะะพั ัะถะต ะทะฐะฟััะตะฝ ั PID: $PID"
        echo "ะะปั ะพััะฐะฝะพะฒะบะธ: ./stop_trading_daemon.sh"
        exit 1
    else
        echo "โ๏ธ ะะฐะนะดะตะฝ ััะฐััะน PID ัะฐะนะป, ัะดะฐะปัะตะผ..."
        rm -f "$PID_FILE"
    fi
fi

# ะกะพะทะดะฐะตะผ ะดะธัะตะบัะพัะธั ะดะปั ะปะพะณะพะฒ ะตัะปะธ ะตั ะฝะตั
mkdir -p logs

# ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต ั nohup
echo "๐ ะะฐะฟััะบ ัะพัะณะพะฒะพะณะพ ะฑะพัะฐ..."
nohup python3 "$PYTHON_SCRIPT" > "logs/$LOG_FILE" 2>&1 &

# ะกะพััะฐะฝัะตะผ PID
echo $! > "$PID_FILE"
PID=$(cat "$PID_FILE")

echo "โ ะะพั ะทะฐะฟััะตะฝ ั PID: $PID"
echo "๐ ะะพะณะธ: logs/$LOG_FILE"
echo "๐ PID ัะฐะนะป: $PID_FILE"
echo ""
echo "๐ฑ ะัะพะฒะตััะนัะต Telegram ะดะปั ัะฒะตะดะพะผะปะตะฝะธะน!"
echo ""
echo "๐ง ะะพะผะฐะฝะดั ัะฟัะฐะฒะปะตะฝะธั:"
echo "  ะััะฐะฝะพะฒะบะฐ: ./stop_trading_daemon.sh"
echo "  ะกัะฐััั: ./status_trading_daemon.sh"
echo "  ะะพะณะธ: tail -f logs/$LOG_FILE"
echo ""
echo "๐ ะะพะถะตัะต ะฒัะบะปััะฐัั ะฝะพัั - ะฑะพั ะฟัะพะดะพะปะถะธั ัะฐะฑะพัะฐัั!" 